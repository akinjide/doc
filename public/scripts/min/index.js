angular.module("myApp",["ui.router","ngMaterial","ngCookies","angular-loading-bar"]),angular.module("myApp").config(["$stateProvider","$urlRouterProvider","$locationProvider","cfpLoadingBarProvider",function(e,t,o,n){t.otherwise("/404/notfound"),e.state("404",{url:"/404/notfound",templateUrl:"../partials/404.partial.html"}).state("sm-signin",{url:"/xs-sc_598/signin",templateUrl:"../partials/sm-signin.partial.html"}).state("home",{url:"/",templateUrl:"../partials/home.partial.html"}).state("adddocument",{url:"/documents/add",templateUrl:"../partials/adddoc.partial.html"}).state("editdocument",{url:"/documents/edit_/_id=:dID",templateUrl:"../partials/editdoc.partial.html"}).state("documents",{url:"/documents",templateUrl:"../partials/docs.partial.html"}).state("profile",{url:"/profile",templateUrl:"../partials/profile.partial.html"}).state("editprofile",{url:"/profile/edit_/_id=:userID",templateUrl:"../partials/editprofile.partial.html"}),o.html5Mode(!0)}]),angular.module("myApp").run(["$http","$cookies","$rootScope","$state","$location","UserService",function(e,t,o,n,a,s){var r=t.get("uT");e.defaults.headers.common["x-access-token"]=r,o.$on("$stateChangeStart",function(e,t){s.checkUser()&&("../partials/home.partial.html"==t.templateUrl||"../partials/sm-signin.partial.html"==t.templateUrl)&&a.path("/documents"),s.checkUser()||("../partials/profile.partial.html"==t.templateUrl||"../partials/editprofile.partial.html"==t.templateUrl||"../partials/docs.partial.html"==t.templateUrl||"../partials/editdoc.partial.html"==t.templateUrl||"../partials/adddoc.partial.html"==t.templateUrl)&&a.path("/")})}]),function(){angular.module("myApp").controller("docController",["$scope","$log","DocService","$state","$cookies","$mdToast",function(e,t,o,n,a,s){function r(e){s.show(s.simple().content(e).position("top right").hideDelay(3e3))}var u=a.get("dID");u&&o.getDocument(u).then(function(t){var o=t.data;e.param=o.response}),e.createDocument=function(e){o.createDocument(e).then(function(e){var t=e.data;201===t.statusCode?(r(t.statusMessage),n.go("documents")):500===t.statusCode?r(t.statusMessage):403===t.statusCode?r(t.statusMessage):409===t.statusCode&&r("Document with similar title already exist!")})},e.edit=function(e){a.put("dID",e),n.go("editdocument",{dID:e})},e.updateDocument=function(e){var t=a.get("dID");swal({title:"Are you sure?",text:"You will not be able to recover previous document!",type:"warning",showCancelButton:!0,confirmButtonColor:"#90BAE8",confirmButtonText:"Yes, update it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(a){a?(o.updateDocument(t,e).then(function(e){var t=e.data;200===t.statusCode?n.go("documents"):500===t.statusCode&&r(t.statusMessage)}),swal("Updated!","Your document has been updated.","success")):(n.reload(),swal("Cancelled","Your document is safe :)","error"))})},e.deleteDocument=function(e){swal({title:"Are you sure?",text:"You will not be able to recover this document!",type:"warning",showCancelButton:!0,confirmButtonColor:"#F58080",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(o.deleteDocument(e).then(function(e){var t=e.data;200===t.statusCode?(a.remove("dID"),n.reload()):500===t.statusCode&&r(t.statusMessage)}),swal("Deleted!","Your document has been deleted!","success")):swal("Cancelled","Your document is safe :)","error")})}}])}(),function(){angular.module("myApp").controller("materialController",["$scope","$timeout","$mdSidenav","$log",function(e,t,o,n){function a(o,n,a){var s;return function(){var a=e,r=Array.prototype.slice.call(arguments);t.cancel(s),s=t(function(){s=void 0,o.apply(a,r)},n||10)}}function s(e){return a(function(){o(e).toggle().then(function(){n.debug("toggle "+e+" is done")})},200)}e.toggleLeft=s("left"),e.isOpenRight=function(){return o("right").isOpen()}}]).controller("LeftCtrl",["$scope","$timeout","$mdSidenav","$log",function(e,t,o,n){e.close=function(){o("left").close().then(function(){n.debug("close LEFT is done")})}}])}(),function(){angular.module("myApp").controller("userController",["$scope","$log","UserService","$state","$cookies","$mdToast",function(e,t,o,n,a,s){function r(e){var t=new Date;return t.setTime(t.getTime()+24*e*60*60*1e3),t.toGMTString()}function u(e){s.show(s.simple().content(e).action("OK").position("top right"))}function l(e){s.show(s.simple().content(e).position("top right").hideDelay(3e3))}var i=a.get("uID");e.login=function(e){o.userLogin(e).then(function(e){var t=e.data;if(200===t.statusCode){var o=t.response;a.put("uT",o.token,{expires:r(1)}),a.put("uID",o.user._id,{expires:r(1)}),l(t.statusMessage),n.go("documents")}else 400===t.statusCode?400===t.statusCode&&"Already logged in"===t.statusMessage?(n.go("profile"),l(t.statusMessage)):l(t.statusMessage+", are you trying to create an account?"):500===t.statusCode&&l(t.statusMessage)})},e.createUser=function(e){o.createUser(e).then(function(e){var t=e.data;201===t.statusCode?(n.reload(),u(t.statusMessage+", Please sign in, to continue")):400===t.statusCode?l(t.statusMessage):403===t.statusCode?l(t.statusMessage):409===t.statusCode&&l(t.statusMessage)})},i&&o.getUser(i).then(function(t){var o=t.data;e.vm=o.response}),e.logout=function(){o.userLogout().then(function(e){var t=e.data;200===t.statusCode?(l(t.statusMessage),a.remove("uID"),a.remove("dID"),a.remove("session"),n.go("home")):401===t.statusCode?l(t.statusMessage):500===t.statusCode&&l(t.statusMessage)})},e.edit=function(e){n.go("editprofile",{userID:e})},e.updateUser=function(e){var t=a.get("uID");swal({title:"Are you sure?",text:"You will not be able to recover previous details!",type:"warning",showCancelButton:!0,confirmButtonColor:"#90BAE8",confirmButtonText:"Yes, update it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(a){a?(o.updateUser(t,e).then(function(e){var t=e.data;200===t.statusCode?n.go("profile"):500===t.statusCode&&l(t.statusMessage)}),swal("Updated!","Your profile has been updated.","success")):(n.reload(),swal("Cancelled","Your profile is safe :)","error"))})},e.deleteUser=function(e){swal({title:"Are you sure?",text:"You will not be able to recover this profile, please read the T&A below!",type:"warning",showCancelButton:!0,confirmButtonColor:"#F58080",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",closeOnConfirm:!1,closeOnCancel:!1},function(t){t?(o.deleteUser(e).then(function(e){var t=e.data;200===t.statusCode?(a.remove("uID"),a.remove("uT"),a.remove("dID"),n.go("home")):500===t.statusCode&&l(t.statusMessage)}),swal("Deleted!","Your profile has been deleted, Really sad you leaving","success")):swal("Cancelled","Your profile is safe :)","error")})},i&&o.getUserDocuments(i).then(function(t){var o=t.data;200===o.statusCode?e.userDocuments=o.response:500===o.statusCode?l(o.statusMessage):204===o.statusCode&&l("You don't have any document, create one now :)")})}])}(),angular.module("myApp").value("documentAPI","/api/documents").factory("DocService",["$http","documentAPI",function(e,t){return{createDocument:function(o){return e.post(t,{title:o.title,content:o.content})},getDocuments:function(){return e.get(t)},getDocument:function(o){return e.get(t+"/"+o)},updateDocument:function(o,n){return e.put(t+"/"+o,{title:n.title,content:n.content})},deleteDocument:function(o){return e["delete"](t+"/"+o)}}}]),angular.module("myApp").value("userAPI","/api/users").factory("UserService",["$http","$log","userAPI","$cookies",function(e,t,o,n){return{createUser:function(t){return e.post(o,{username:t.username,name:{first:t.first,last:t.last},email:t.email,password:t.password})},checkUser:function(){var e=n.get("uID");return e?!0:!1},userLogin:function(t){return e.post(o+"/login",{username:t.username,password:t.password})},userLogout:function(){return e.post(o+"/logout")},getUsers:function(){return e.get(o)},getUser:function(t){return e.get(o+"/"+t)},updateUser:function(t,n){return e.put(o+"/"+t,{username:n.username,name:{first:n.name.first,last:n.name.last},email:n.email})},deleteUser:function(t){return e["delete"](o+"/"+t)},getUserDocuments:function(t){return e.get(o+"/"+t+"/documents")}}}]);